<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>LinkSmart Status and Configuration Tool</title>
<link rel="stylesheet" href="LinkSmartStatus/css/style.css" type="text/css" media="all" />
<script type="text/javascript" src="LinkSmartStatus/js/prototype.js"></script>
<script type="text/javascript" src="LinkSmartStatus/js/configurator.js"></script>
<script type="text/javascript" src="LinkSmartStatus/js/networkManagerStatus.js"></script>
<script type="text/javascript" src="LinkSmartStatus/js/eventManagerStatus.js"></script>
<script type="text/javascript" src="LinkSmartStatus/lib/prototype/prototype.js"></script>
<script type="text/javascript" src="LinkSmartStatus/lib/scriptaculous/scriptaculous.js"></script>
<script type="text/javascript" src="LinkSmartStatus/lib/scriptaculous/slider.js"></script>
<script type="text/javascript" src="LinkSmartStatus/js/scroll.js"></script>
<script type="text/javascript" src="LinkSmartStatus/js/textwrapper.js"></script>
</head>
<body>
<div id="wrapper">
  <div id="header">
  	<p class="logoimage">
  		<img src="LinkSmartStatus/images/linksmartlogo.gif" width=100/>
  	</p>
    <p class="logotext">LinkSmart<strong>Status</strong></p>
  </div>
  <div id="options"></div>
  <div id="nav">
  </div>
  <div id="content">
    <div id="left">
      <h2>Available Configurations</h2>
    </div>
    <div id="right">
	    <div id="selectedconftitle">
	    	<h1>No configuration selected yet</h1>
		</div>	
		<table class="tabletitle">
	      		<tr>
	      			<td class="tabletdleft">
	      				Property
	      			</td>
					<td class="tabletdright">
						Value
					</td>
	      		</tr>
	      	</table>
	    <div id="selectedconfcontent">  
		</div>
    </div>
  </div>
  <br class="clear" />
  <div id="footer">
    <p><center>All content copyright &copy; 2009 <strong>LinkSmart project</strong>, all rights reserved.</center></p>
  </div>
</div>
</body>
<script type="text/javascript" charset="utf-8">	
	
var networkManagerInfo;
var eventManagerInfo;
var optionTabs = '{"configurator":"false", "network":"false", "event":"false", "tabs":0, "selected":"", "selectedText":"" }'.evalJSON();
var timerOption;

getConfigurations();
getNetworkManagerInfo();
getEventManagerInfo();
update();
timerOption = setInterval("getConfigurations()",5000);
setInterval("update()",5000);

function startConfigurator() {
	clearInterval(timerOption);
	var text = "<div id=\"left\"><h2>Available Configurations</h2></div>";
    text += "<div id=\"right\"><div id=\"selectedconftitle\"><h1>No configuration selected yet</h1></div>";	
	text +=	"<table class=\"tabletitle\"><tr><td class=\"tabletdleft\">Property</td><td class=\"tabletdright\">Value</td></tr></table>";
	text += "<div id=\"selectedconfcontent\"></div></div>";
	document.getElementById("content").innerHTML = text;
	getConfigurations();
	timerOption = setInterval("getConfigurations()",5000);
}

function startNetworkManagerStatus() {
	clearInterval(timerOption);
	var text = "<div id=\"suboptions\"><div class=\"left-tab-2\" id=\"networkManagers\" onclick=\"showNetworkManagers()\" style=\"position:absolute; left:0px; z-index:7\"><h3>Network Managers</h3></div>";
	text += "<div class=\"normal-tab-2\" id=\"localHids\" onclick=\"showLocalHids()\" style=\"position:absolute; left:167px; z-index:6\"><h3>Local HIDs</h3></div>";
	text += "<div class=\"normal-tab-2\" id=\"remoteHids\" onclick=\"showRemoteHids()\" style=\"position:absolute; left:335px; z-index:5\"><h3>Remote HIDs</h3></div></div>";
	text += "<div id=\"search\"><div style=\"float:left; width:250px\"><h3>Seach Network Manager Entities: </h3></div><input id=\"searchtext\" type=\"text\" value=\"\" onkeypress=\"showNetworkManagerSearch(event)\"/></div>";
	text += "<div id=\"infoContent\"></div>";
	document.getElementById("content").innerHTML = text;
	showNetworkManagers();
}

function showNetworkManagers() {
	getNetworkManagers();	
}

function showLocalHids() {
	getLocalHids();
}

function showRemoteHids() {
	getRemoteHids();
}

function showNetworkManagerSearch(event) {
	var search = document.getElementById('searchtext').value
	var keynum = event.which;
	if (keynum == 13) {
		getNetworkManagerSearch(search);
	}
}

function startEventManagerStatus() {
	clearInterval(timerOption);
	var text = "<div id=\"searchEvent\"><div style=\"float:left; width:250px\"><h3>Seach Event Subscriptions: </h3></div><input id=\"searchEventtext\" type=\"text\" value=\"\" onkeypress=\"showEventManagerSearch(event)\"/></div>";
	text += "<div id=\"infoContent\"></div>";
	document.getElementById("content").innerHTML = text;
	getEventManagerSubscriptions();
	
}

function showEventManagerSearch(event) {
	var search = document.getElementById('searchEventtext').value
	var keynum = event.which;
	if (keynum == 13) {
		getEventManagerSearch(search);
	}
}

function update (){
	optionTabs.tabs = 0;
	new Ajax.Request('http://localhost:8082/GetNetworkManagerStatus', {
		method: 'get',
		parameters: {},
		onComplete: function(transport){
			var response = transport.responseText;
			if (response.indexOf("Error 404") != -1) optionTabs.network = "false";
			else {
				optionTabs.network = "true";
				optionTabs.tabs += 1;
			}
		}
	});
	new Ajax.Request('http://localhost:8082/GetEventManagerSubscriptions', {
		method: 'get',
		parameters: {},
		onComplete: function(transport){
			var response = transport.responseText;
			if (response.indexOf("Error 404") != -1) optionTabs.event = "false";
			else {
				optionTabs.event = "true";
				optionTabs.tabs += 1;
			}
		}
	});
	new Ajax.Request('http://localhost:8082/LinkSmartConfigurator/GetConfiguration', {
		method: 'get',
		parameters: {},
		onComplete: function(transport){
			var response = transport.responseText;
			if (response.indexOf("Error 404") != -1) optionTabs.configurator = "false";
			else {
				optionTabs.configurator = "true";
				optionTabs.tabs += 1;
			}
		}
	});
	setTimeout("printUpdated()",500);
}

function printUpdated (){
	switch (optionTabs.tabs) {
		case 1:
			document.getElementById("options").style.left = "772px";
			break;
		case 2:
			document.getElementById("options").style.left = "522px";
			break;
		case 3:
			document.getElementById("options").style.left = "272px";
			break;
	}
	var text = "";
	if ((optionTabs.configurator == "true")&&(optionTabs.network == "false")&&(optionTabs.event == "false")) {
		text += "<div class=\"right-tab\" id=\"configuratorTab\" onclick=\"startConfigurator()\" style=\"position:absolute; left:0px; z-index:5\"><h3>LinkSmart Configurator</h3></div>";
	}
	else if ((optionTabs.configurator == "true")&&(optionTabs.network == "true")&&(optionTabs.event == "false")) {
		text += "<div class=\"normal-tab\" id=\"configuratorTab\" onclick=\"startConfigurator()\" style=\"position:absolute; left:0px; z-index:5\"><h3>LinkSmart Configurator</h3></div>";
		text += "<div class=\"right-tab\" id=\"networkTab\" onclick=\"startNetworkManagerStatus()\" style=\"position:absolute; left:250px; z-index:6\"><h3>Network Manager Status</h3></div>";
		getNetworkManagerInfo();
	}
	else if ((optionTabs.configurator == "true")&&(optionTabs.network == "false")&&(optionTabs.event == "true")) {
		text += "<div class=\"normal-tab\" id=\"configuratorTab\" onclick=\"startConfigurator()\" style=\"position:absolute; left:0px; z-index:5\"><h3>LinkSmart Configurator</h3></div>";
		text += "<div class=\"right-tab\" id=\"eventTab\" onclick=\"startEventManagerStatus()\" style=\"position:absolute; left:250px; z-index:6\"><h3>Event Manager Status</h3></div>";
		getEventManagerInfo();
	}
	else if ((optionTabs.configurator == "true")&&(optionTabs.network == "true")&&(optionTabs.event == "true")) {
		text += "<div class=\"normal-tab\" id=\"configuratorTab\" onclick=\"startConfigurator()\" style=\"position:absolute; left:0px; z-index:5\"><h3>LinkSmart Configurator</h3></div>";
		text += "<div class=\"normal-tab\" id=\"networkTab\" onclick=\"startNetworkManagerStatus()\" style=\"position:absolute; left:250px; z-index:6\"><h3>Network Manager Status</h3></div>";
		text += "<div class=\"right-tab\" id=\"eventTab\" onclick=\"startEventManagerStatus()\" style=\"position:absolute; left:500px; z-index:6\"><h3>Event Manager Status</h3></div>";
		getNetworkManagerInfo();
		getEventManagerInfo();
	}
	document.getElementById("options").innerHTML = text;
}

</script>
</html>
