<?xml version="1.0" encoding="UTF-8"?>
<project name="linksmart.components.StorageArchitecture.CookieDeviceClientBundle" default="build" basedir=".">
  <property name="moduleName" value="CookieDeviceClientBundle"/>
  <property name="rootBuildDir" value="${basedir}/../../../build"/>
  <property name="rootDistributionDir" value="${basedir}/../../../distribution"/>
  <property name="src.dir" value="${basedir}/src"/>
  <property name="test.dir" value="${basedir}/test"/>
  <property name="build.dir" value="${rootBuildDir}/${moduleName}/bin"/>
  <property name="lib.dir" value="${rootBuildDir}/${moduleName}/lib"/>
  <property name="lib.dir.local" value="${basedir}/lib"/>
  <property name="distribution.dir" value="${rootDistributionDir}/StorageArchitecture"/>
  <property name="revision" value="1.0"/>
  
  <path id="classpath">
    <fileset dir="${lib.dir}">
      <include name="**/*.jar"/>
    </fileset>
    <pathelement location="${distribution.dir}/StorageManagerCommonBundle.jar"/>
    <pathelement path="${build.dir}"/>
  </path>
  
  <target name="jar" depends="build">
		<echo message="Building jar ${moduleName}"/>
		<mkdir dir="${distribution.dir}"/>
        <mkdir dir="${build.dir}/lib"/>
        <mkdir dir="${build.dir}/META-INF"/>
        <copy file="${basedir}/META-INF/MANIFEST.MF" todir="${build.dir}/META-INF"/>
        <copy todir="${build.dir}/lib">
            <fileset dir="${lib.dir}" includes="*.jar"/>
        </copy>
	<jar destfile="${distribution.dir}/${moduleName}.jar" basedir="${build.dir}" manifest="${build.dir}/META-INF/MANIFEST.MF"/>
        <delete dir="${build.dir}/lib" includeEmptyDirs="true"  failonerror="false"/>
        <delete dir="${build.dir}/META-INF" includeEmptyDirs="true"  failonerror="false"/>
  </target>
  
  <target name="build" depends="resolve-dependencies">
  	<echo message="Building CookieDeviceClientBundle"/>
    <mkdir dir="${build.dir}"/>
    <javac destdir="${build.dir}" classpathref="classpath">   
      <src path="${src.dir}"/>
    </javac>
  </target>
  
  <target name="clean">
    <delete dir="${build.dir}" includeEmptyDirs="true"  failonerror="false"/>
  </target>
  
  <target name="resolve-dependencies">
    <copy todir="${lib.dir}">
        <fileset dir="${lib.dir.local}" includes="*.jar"/>
    </copy>
    <copy file="${distribution.dir}/NetworkManagerClient.jar" toDir="${lib.dir}"/>
  </target>
  
</project>
