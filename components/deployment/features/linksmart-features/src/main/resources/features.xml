<?xml version="1.0" encoding="UTF-8" ?>
<features name="${project.artifactId}" xmlns="http://karaf.apache.org/xmlns/features/v1.0.0">

	<feature name="osgi-core" version="${project.version}">
		<!--
        core OSGi bundles are provisioned by Karaf, hence no need to deploy these bundles     
      	-->
        <bundle>mvn:org.apache.felix/org.apache.felix.scr/${felix.scr.version}</bundle>
        <bundle>mvn:org.apache.felix/org.apache.felix.metatype/${felix.metatype.version}</bundle>
        <!--
        no need to deploy configAdmin, Karaf already provision this bundle   
      	<bundle>mvn:org.apache.felix/org.apache.felix.configadmin/${felix.osgi.configadmin.version}</bundle>  
      	-->
    </feature>
    
    <feature name="osgi-http" version="${project.version}">
    	<feature version="${karaf.version}">http</feature>
		<!--     	
		<bundle>mvn:org.apache.felix/org.apache.felix.http.jetty/${felix.http.version}</bundle>	 
		-->
    </feature>
    
    <feature name="linksmart-boot" version="${project.version}">
    	<feature version="${project.version}">osgi-core</feature>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-lang/${servicemix.commons-lang.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.utils/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.network/${project.version}</bundle>
    </feature>
    
    <feature name="crypto-manager" version="${project.version}">
    	<feature version="${project.version}">linksmart-boot</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.cryptomanager/${project.version}</bundle>
        <bundle dependency="true">mvn:org.bouncycastle/bcprov-jdk16/1.46</bundle>
        <bundle dependency="true">mvn:org.bouncycastle/bcpg-jdk16/1.46</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xmlsec/1.4.5_1</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jdom/1.1_4</bundle>
        <bundle>mvn:org.apache.commons/commons-jexl/2.1.1</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.derby/10.9.1.0_1</bundle>
        <bundle>mvn:javax.transaction/com.springsource.javax.transaction/1.1.0</bundle>
        <bundle>mvn:commons-configuration/commons-configuration/1.9</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.security.cryptomanager/${project.version}</bundle>
    </feature>
    
    <feature name="security-manager-sym" version="${project.version}">
        <feature version="${project.version}">crypto-manager</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.security.communication/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.clients/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.trustmanager/${project.version}</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xmlsec/1.4.5_1</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.security.communicationsecuritymanager.sym/${project.version}</bundle>
    </feature>
    
    <feature name="security-manager-asym" version="${project.version}">
        <feature version="${project.version}">crypto-manager</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.security.communication/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.clients/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.trustmanager/${project.version}</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xmlsec/1.4.5_1</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.security.communicationsecuritymanager.asym/${project.version}</bundle>
    </feature>
    
    <feature name="identity-manager" version="${project.version}">
    	<feature version="${project.version}">crypto-manager</feature>
    	<bundle>mvn:eu.linksmart/eu.linksmart.api.identitymanager/${project.version}</bundle>
    	<bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager.core/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.security.communication/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.trustmanager/${project.version}</bundle>
    	<bundle>mvn:eu.linksmart/eu.linksmart.api.clients/${project.version}</bundle>
    	<bundle>mvn:eu.linksmart/eu.linksmart.api.policy/${project.version}</bundle>
    	<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xmlsec/1.4.5_1</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.identitymanager/${project.version}</bundle>
    </feature>
    
    <feature name="backbone-router" version="${project.version}">
		<feature version="${project.version}">linksmart-boot</feature>		       
        <bundle>mvn:eu.linksmart/eu.linksmart.api.backbone/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.backbone.router/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.security.communication/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager.core/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.router/${parent.version}</bundle>
    </feature>
    
    <feature name="network-manager" version="${project.version}">  
    	<feature version="${project.version}">linksmart-boot</feature> 
    	<feature version="${project.version}">osgi-http</feature>  
    	<feature version="${project.version}">crypto-manager</feature>	
    	<feature version="${project.version}">identity-manager</feature>
        <feature version="${project.version}">security-manager-sym</feature>
        <feature version="${project.version}">security-manager-asym</feature>
        <feature version="${project.version}">backbone-router</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.clients/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.trustmanager/${project.version}</bundle> 
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager.core/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.networkmanager/${project.version}</bundle>
    </feature>
    
    <feature name="trust-manager" version="${project.version}">
    	<feature version="${project.version}">network-manager</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.trustmanager/${project.version}</bundle>
    	<bundle>mvn:eu.linksmart/eu.linksmart.api.clients/${project.version}</bundle>
    	<bundle>mvn:org.bouncycastle/bcprov-jdk16/1.46</bundle>
        <bundle>mvn:org.bouncycastle/bcpg-jdk16/1.46</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.security.trustmanager/${project.version}</bundle>
    </feature>
    
    <feature name="basic-tunnel" version="${project.version}">
    	<feature version="${project.version}">network-manager</feature>
    	<bundle>mvn:eu.linksmart/eu.linksmart.network.tunnel/${project.version}</bundle>
    </feature>
    
    <feature name="standard-tunnel" version="${project.version}">
    	<feature version="${project.version}">basic-tunnel</feature>
    	<bundle>mvn:eu.linksmart/eu.linksmart.network.tunnel.standard/${project.version}</bundle>
    	<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-codec/${commons-codec.version}</bundle>
    	<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-httpclient/${commons-httpclient.version}</bundle>
    </feature>
    
    <feature name="soap-tunnel" version="${project.version}">
    	<feature version="${project.version}">network-manager</feature>
    	<bundle>mvn:eu.linksmart/eu.linksmart.network.soaptunneling/${project.version}</bundle>
    	<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-codec/${commons-codec.version}</bundle>
    	<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-httpclient/${commons-httpclient.version}</bundle>
    </feature>
    
    <feature name="backbone-osgi" version="${project.version}">
        <feature version="${project.version}">backbone-router</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.impl.osgi/${parent.version}</bundle>
    </feature>
    
    <feature name="backbone-soap" version="${project.version}">
        <feature version="${project.version}">backbone-router</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.soap/${parent.version}</bundle>
    </feature>
    
    <feature name="backbone-jxta" version="${project.version}">
        <feature version="${project.version}">backbone-router</feature>
        <bundle>mvn:org.mortbay.jetty/com.springsource.org.mortbay.jetty/4.2.22</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.jxta/${parent.version}</bundle>
    </feature>
    
    <feature name="backbone-data" version="${project.version}">
        <feature version="${project.version}">backbone-router</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.data/${parent.version}</bundle>
    </feature>
    
    <feature name="configurator-manager" version="${project.version}">
        <feature version="${project.version}">linksmart-boot</feature> 
    	<feature version="${project.version}">osgi-http</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.config.managerconfigurator/${parent.version}</bundle>
    </feature>
    
    <feature name="grand-message-handler" version="${project.version}">
        <feature version="${project.version}">network-manager</feature>
    	<bundle>mvn:eu.linksmart/eu.linksmart.network.tunnel/${project.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.grand/${parent.version}</bundle>
    </feature>
    
    <feature name="linksmart" version="${project.version}">
    	<feature version="${project.version}">network-manager</feature>
        <feature version="${project.version}">trust-manager</feature>
        <feature version="${project.version}">basic-tunnel</feature>
        <feature version="${project.version}">standard-tunnel</feature>
        <feature version="${project.version}">soap-tunnel</feature>
        <feature version="${project.version}">backbone-osgi</feature>
        <feature version="${project.version}">backbone-soap</feature>
        <feature version="${project.version}">backbone-jxta</feature>
        <feature version="${project.version}">backbone-data</feature>
        <feature version="${project.version}">grand-message-handler</feature>
        <feature version="${project.version}">configurator-manager</feature>
    </feature>
    
    <feature name="linksmart-ws-provider" version="${project.version}"> 
		<feature>cxf-dosgi-discovery-distributed</feature>
    </feature>
    
    <!--  Calculator Example Service FEATURE -->
<!--     <feature name="linksmart-example-service" version="${project.version}">  -->
<!--     	<feature version="${project.version}">linksmart</feature> -->
<!--     	<feature version="${project.version}">linksmart-ws-provider</feature> -->
<!--     	<bundle>mvn:eu.linksmart.examples/calculator-service/${project.version}</bundle> -->
<!--         <bundle>mvn:eu.linksmart.examples/calculator-consumer/${project.version}</bundle> -->
<!--     </feature> -->
       
    <!--  INTEGRATION FEATURES -->
    
    <feature name="backbone-router-it" version="${project.version}">
        <feature version="${project.version}">backbone-router</feature>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.impl.osgi/${parent.version}</bundle>
    </feature>

    <feature name="backbone-jxta-it" version="${project.version}">
        <bundle>mvn:org.apache.felix/org.apache.felix.scr/${felix.scr.version}</bundle>
        <bundle>mvn:org.apache.felix/org.apache.felix.metatype/${felix.metatype.version}</bundle>
        <bundle>mvn:org.mortbay.jetty/com.springsource.org.mortbay.jetty/4.2.22</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.bcpg-jdk16/${servicemix.bcpg-jdk16}</bundle>
        <bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-lang/${servicemix.commons-lang.version}</bundle>
        <bundle>mvn:org.apache.felix/org.apache.felix.configadmin/${felix.osgi.configadmin.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.config.managerconfigurator/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.utils/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.backbone/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.network/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.security.communication/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.backbone.router/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager.core/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.api.networkmanager/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.router/${parent.version}</bundle>
        <bundle>mvn:eu.linksmart/eu.linksmart.network.backbone.jxta/${parent.version}</bundle>
    </feature>


</features>
